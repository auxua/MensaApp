<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:viewModels="clr-namespace:MensaApp.PageModels"
             xmlns:models="clr-namespace:MensaApp.Models"
             xmlns:res="clr-namespace:MensaApp.Resources.Strings"
             x:Class="MensaApp.Pages.SettingsPage"
             x:DataType="viewModels:SettingsPageModel"
             Title="{x:Static res:AppRessources.Settings}">

    <ContentPage.Resources>
        <ResourceDictionary>

            <Color x:Key="SettingsBgLight">#F6F6F6</Color>
            <Color x:Key="SettingsBgDark">#121212</Color>

            <Color x:Key="CardBgLight">#FFFFFF</Color>
            <Color x:Key="CardBgDark">#1E1E1E</Color>

            <Color x:Key="PrimaryTextLight">#111111</Color>
            <Color x:Key="PrimaryTextDark">#FFFFFF</Color>

            <Color x:Key="SecondaryTextLight">#666666</Color>
            <Color x:Key="SecondaryTextDark">#BBBBBB</Color>

            <Color x:Key="SeparatorLight">#E5E5E5</Color>
            <Color x:Key="SeparatorDark">#2A2A2A</Color>

            <!-- Styles -->
            <Style x:Key="SectionTitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor"
                    Value="{AppThemeBinding Light={StaticResource SecondaryTextLight},
                                            Dark={StaticResource SecondaryTextDark}}" />
                <Setter Property="Margin" Value="4,16,4,8"/>
            </Style>

            <Style x:Key="CardStyle" TargetType="Border">
                <Setter Property="StrokeThickness" Value="0"/>
                <Setter Property="StrokeShape" Value="RoundRectangle 16"/>
                <Setter Property="Background"
                    Value="{AppThemeBinding Light={StaticResource CardBgLight},
                                         Dark={StaticResource CardBgDark}}" />
                <Setter Property="Padding" Value="12"/>
            </Style>

            <Style x:Key="RowTitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="TextColor"
                    Value="{AppThemeBinding Light={StaticResource PrimaryTextLight},
                                         Dark={StaticResource PrimaryTextDark}}" />
            </Style>

            <Style x:Key="RowDetailStyle" TargetType="Label">
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="TextColor"
                    Value="{AppThemeBinding Light={StaticResource SecondaryTextLight},
                                            Dark={StaticResource SecondaryTextDark}}" />
                <Setter Property="Margin" Value="0,2,0,0"/>
            </Style>

            <Style x:Key="SeparatorStyle" TargetType="BoxView">
                <Setter Property="HeightRequest" Value="1"/>
                <Setter Property="HorizontalOptions" Value="Fill"/>
                <Setter Property="Background"
                    Value="{AppThemeBinding Light={StaticResource CardBgLight},
                                         Dark={StaticResource CardBgDark}}" />
            </Style>

        </ResourceDictionary>
    </ContentPage.Resources>

    <ContentPage.BackgroundColor>
        {AppThemeBinding Light={StaticResource SettingsBgLight},
                    Dark={StaticResource SettingsBgDark}}
    </ContentPage.BackgroundColor>

    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="12">

            <!-- Section 1 -->
            <Label Text="Filter" Style="{StaticResource SectionTitleStyle}" />

            <Border Style="{StaticResource CardStyle}">
                <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto">
                    <Label Text="{x:Static res:AppRessources.MainDishesOnly}"
                           Style="{StaticResource RowTitleStyle}"
                           VerticalOptions="Center" />
                    <Switch Grid.Column="1"
                            IsToggled="{Binding OnlyMainDishes}"
                            VerticalOptions="Center" />
                </Grid>
            </Border>

            <!-- Section 2 -->
            <Label Text="Mensen auswählen" Style="{StaticResource SectionTitleStyle}" />

            <Border Style="{StaticResource CardStyle}">
                <VerticalStackLayout Spacing="0">

                    <CollectionView ItemsSource="{Binding Mensen}"
                                    SelectionMode="None"
                                    ItemSizingStrategy="MeasureAllItems">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="viewModels:MensaToggleItem">
                                <Grid ColumnDefinitions="*,Auto" Padding="0,10">
                                    <Label Text="{Binding Name}"
                                           Style="{StaticResource RowTitleStyle}"
                                           VerticalOptions="Center" />
                                    <Switch Grid.Column="1"
                                            IsToggled="{Binding IsEnabled}"
                                            VerticalOptions="Center" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Border>

            <!-- Section 3 -->
            <Label Text="Weiteres" Style="{StaticResource SectionTitleStyle}" />

            <Border Style="{StaticResource CardStyle}">
                <VerticalStackLayout Spacing="0">

                    <!-- Reload -->
                    <Grid Padding="0,10" ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Spacing="0">
                            <Label Text="Daten neu laden" Style="{StaticResource RowTitleStyle}" />
                            <Label Text="Kann einige Sekunden dauern"
                                   Style="{StaticResource RowDetailStyle}" />
                        </VerticalStackLayout>

                        <Label Grid.Column="1"
                               Text="›"
                               FontSize="22"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource SecondaryTextLight},
                                                       Dark={StaticResource SecondaryTextDark}}" />
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ReloadDataCommand}" />
                        </Grid.GestureRecognizers>
                    </Grid>

                    <BoxView Style="{StaticResource SeparatorStyle}" />

                    <!-- Privacy -->
                    <Grid Padding="0,10" ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Spacing="0">
                            <Label Text="Datenschutz" Style="{StaticResource RowTitleStyle}" />
                            <Label Text="Tippen für Details (öffnet Browser)"
                                   Style="{StaticResource RowDetailStyle}" />
                        </VerticalStackLayout>

                        <Label Grid.Column="1"
                               Text="›"
                               FontSize="22"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource SecondaryTextLight},
                                                       Dark={StaticResource SecondaryTextDark}}" />
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding OpenPrivacyCommand}" />
                        </Grid.GestureRecognizers>
                    </Grid>

                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
